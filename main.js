import { Template } from 'meteor/templating';
import { ReactiveVar } from 'meteor/reactive-var';

import './main.html';

contractAddress=""

ABIArray=[{"constant":false,"inputs":[{"name":"data","type":"string"},
{"name":"time","type":"string"},{"name":"patientId","type":"uint256"}],
"name":"storeData","outputs":[],"payable":false,"type":"function"},
{"constant":true,"inputs":[{"name":"index","type":"uint256"}],"name":"accessData","outputs":
[{"name":"data","type":"string"},{"name":"timestamp","type":"string"},{"name":"patientId","type":"uint256"}],
"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"numRecords","outputs":[{"name":"","type":"uint256"}],
"payable":false,"type":"function"}]

data=60606040526000600155341561001457600080fd5b5b610540806100246000396000f30060606040526
000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063524a
a75a1461005457806353177c9f146100fd578063b5d1990d1461020e575b600080fd5b341561005f57600080fd
5b6100fb600480803590602001908201803590602001908080601f01602080910402602001604051908101604052
80939291908181526020018383808284378201915050505050509190803590602001908201803590602001908080601
f01602080910402602001604051908101604052809392919081815260200183838082843782019150505050505091908035
906020019091905050610237565b005b341561010857600080fd5b61011e60048080359060200190919050506102c3565b604
051808060200180602001848152602001838103835286818151815260200191508051906020019080838360005b838110156101
695780820151818401525b60208101905061014d565b50505050905090810190601f1680156101965780820380516001836020036
101000a031916815260200191505b50838103825285818151815260200191508051906020019080838360005b838110156101d057808
20151818401525b6020810190506101b4565b50505050905090810190601f1680156101fd5780820380516001836020036101000a0319
16815260200191505b509550505050505060405180910390f35b341561021957600080fd5b610221610455565b6040518082815260200191
505060405180910390f35b826000806001548152602001908152602001600020600201908051906020019061026292919061045b565b508160
00806001548152602001908152602001600020600001908051906020019061028e92919061045b565b5080600080600154815260200190815260
2001600020600101819055506001600081548092919060010191905055505b505050565b6102cb6104db565b6102d36104db565b60008060008581
526020019081526020016000206002018054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291
908181526020018280546001816001161561010002031660029004801561037e5780601f106103535761010080835404028352916020019161037e565
b820191906000526020600020905b81548152906001019060200180831161036157829003601f168201915b50505050509250600080858152602001908
1526020016000206000018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001
8280546001816001161561010002031660029004801561042e5780601f106104035761010080835404028352916020019161042e565b820191906000526
020600020905b81548152906001019060200180831161041157829003601f168201915b50505050509150600080858152602001908152602001600020600
1015490505b9193909250565b60015481565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1
061049c57805160ff19168380011785556104ca565b828001600101855582156104ca579182015b828111156104c957825182559160200191906001019061
04ae565b5b5090506104d791906104ef565b5090565b602060405190810160405280600081525090565b61051191905b8082111561050d5760008160009055
506001016104f5565b5090565b905600a165627a7a7230582084a864f5b0184201509819b3f023b40b1107e6f688f2f50dede5d45860a02fe00029


Template.hello.onCreated(function helloOnCreated() {
  // counter starts at 0
  this.counter = new ReactiveVar(0);
});


Template.hello.helpers({
  counter() {
  	var template = Template.instance();
PatientData = web3.eth.contract(ABIArray).at(contractAddress);
  	PatientData.storeData(function(err,res){
  		TemplateVar.set(template,"counter",res)
  	})
    PatientData.accessData(function(err,res){
  		TemplateVar.set(template,"counter",res)
  	})
  },
});

Template.hello.events({
  'click button'(event, instance) {
    // increment the counter when button is clicked
    instance.counter.set(instance.counter.get() + 1);
  },
});
